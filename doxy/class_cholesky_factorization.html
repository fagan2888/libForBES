<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LibForBES: CholeskyFactorization Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dox_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">LibForBES
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Solver for nonsmooth convex optimization problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_cholesky_factorization-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CholeskyFactorization Class Reference<div class="ingroups"><a class="el" href="group___lin_sys_solver-group.html">Linear systems solvers</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Cholesky factorization and solver.  
 <a href="class_cholesky_factorization.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_cholesky_factorization_8h_source.html">CholeskyFactorization.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CholeskyFactorization:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_cholesky_factorization__inherit__graph.svg" width="163" height="262"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for CholeskyFactorization:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_cholesky_factorization__coll__graph.svg" width="199" height="283"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7b57d2c2ed95f5b959f96748c02c8c15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cholesky_factorization.html#a7b57d2c2ed95f5b959f96748c02c8c15">CholeskyFactorization</a> (<a class="el" href="class_matrix.html">Matrix</a> &amp;<a class="el" href="class_matrix_solver.html#a1f4b65996a1c556075c6c93cac2ce483">m_matrix</a>)</td></tr>
<tr class="separator:a7b57d2c2ed95f5b959f96748c02c8c15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e34c50b16d9f5040997a8ec6e00b0e4"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cholesky_factorization.html#a4e34c50b16d9f5040997a8ec6e00b0e4">factorize</a> ()</td></tr>
<tr class="separator:a4e34c50b16d9f5040997a8ec6e00b0e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e46b9cc9fd6390847563468edc06350"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cholesky_factorization.html#a7e46b9cc9fd6390847563468edc06350">solve</a> (<a class="el" href="class_matrix.html">Matrix</a> &amp;rhs, <a class="el" href="class_matrix.html">Matrix</a> &amp;solution)</td></tr>
<tr class="separator:a7e46b9cc9fd6390847563468edc06350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_factored_solver"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_factored_solver')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_factored_solver.html">FactoredSolver</a></td></tr>
<tr class="memitem:a5609fdc9ea5bcafac92f27c62899570e inherit pub_methods_class_factored_solver"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_factored_solver.html#a5609fdc9ea5bcafac92f27c62899570e">FactoredSolver</a> (<a class="el" href="class_matrix.html">Matrix</a> &amp;matrix)</td></tr>
<tr class="separator:a5609fdc9ea5bcafac92f27c62899570e inherit pub_methods_class_factored_solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_class_matrix_solver"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_class_matrix_solver')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="class_matrix_solver.html">MatrixSolver</a></td></tr>
<tr class="memitem:a919ab90c1bae3454861e000bd57e822a inherit pro_methods_class_matrix_solver"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_matrix_solver.html#a919ab90c1bae3454861e000bd57e822a">MatrixSolver</a> (<a class="el" href="class_matrix.html">Matrix</a> &amp;matrix)</td></tr>
<tr class="separator:a919ab90c1bae3454861e000bd57e822a inherit pro_methods_class_matrix_solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_matrix_solver"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_matrix_solver')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_matrix_solver.html">MatrixSolver</a></td></tr>
<tr class="memitem:a1f4b65996a1c556075c6c93cac2ce483 inherit pro_attribs_class_matrix_solver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_matrix.html">Matrix</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_matrix_solver.html#a1f4b65996a1c556075c6c93cac2ce483">m_matrix</a></td></tr>
<tr class="separator:a1f4b65996a1c556075c6c93cac2ce483 inherit pro_attribs_class_matrix_solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9588f72836b64459951f49d5b7424f inherit pro_attribs_class_matrix_solver"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_matrix.html#a5269c84de25f7f2ac7d05efcffde1046">Matrix::MatrixType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_matrix_solver.html#a2f9588f72836b64459951f49d5b7424f">m_matrix_type</a></td></tr>
<tr class="separator:a2f9588f72836b64459951f49d5b7424f inherit pro_attribs_class_matrix_solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1a6b9d5e56de4bbbb632d6894becee inherit pro_attribs_class_matrix_solver"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_matrix_solver.html#aef1a6b9d5e56de4bbbb632d6894becee">m_matrix_nrows</a></td></tr>
<tr class="separator:aef1a6b9d5e56de4bbbb632d6894becee inherit pro_attribs_class_matrix_solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa8418955584413b8cb2352e45d6669d inherit pro_attribs_class_matrix_solver"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_matrix_solver.html#afa8418955584413b8cb2352e45d6669d">m_matrix_ncols</a></td></tr>
<tr class="separator:afa8418955584413b8cb2352e45d6669d inherit pro_attribs_class_matrix_solver"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Cholesky factorization and solver. </p>
<dl class="section version"><dt>Version</dt><dd>0.5 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Pantelis Sopasakis </dd></dl>
<dl class="section date"><dt>Date</dt><dd>August 4, 2015, 8:14 PM</dd></dl>
<p>This class computes internally a Cholesky factorization of a given symmetric positive definite matrix \(A\) which can then be used to solve linear systems.</p>
<p>Here is an example of use:</p>
<div class="fragment"><div class="line"><span class="keywordtype">size_t</span> n = 20;</div>
<div class="line"></div>
<div class="line"><a class="code" href="class_matrix.html">Matrix</a> A = <a class="code" href="class_matrix_factory.html#a428c5bf7e3aadbbfebac2f6b699a3649">MatrixFactory::MakeRandomMatrix</a>(n, n, 0.0, 0.1, <a class="code" href="class_matrix.html#a5269c84de25f7f2ac7d05efcffde1046a1dda72be4635b65b8d689ec7583239a1">Matrix::MATRIX_SYMMETRIC</a>);</div>
<div class="line"><a class="code" href="class_matrix.html">Matrix</a> Y = <a class="code" href="class_matrix_factory.html#a0d117cb97f8ba22a3ee31137c0fdcdb0">MatrixFactory::MakeIdentity</a>(n, 1.0);</div>
<div class="line">A += Y;</div>
<div class="line"></div>
<div class="line"><a class="code" href="class_matrix.html">Matrix</a> ID(n, n, <a class="code" href="class_matrix.html#a5269c84de25f7f2ac7d05efcffde1046a8201b6f37bd6e24656d4a7a6778caaab">Matrix::MATRIX_DIAGONAL</a>);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n; ++j) {</div>
<div class="line">     ID.set(j, j, 1 / A.<a class="code" href="class_matrix.html#ade6530fe4f127ba13a7030b5e48e2859">get</a>(j, j));</div>
<div class="line">}</div>
<div class="line"><a class="code" href="class_matrix_operator.html">MatrixOperator</a> Aop(A);</div>
<div class="line"><a class="code" href="class_matrix_operator.html">MatrixOperator</a> M(ID);</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">size_t</span> max_iter = n;</div>
<div class="line"><a class="code" href="class_factored_solver.html">FactoredSolver</a> * cholesky = <span class="keyword">new</span> <a class="code" href="class_cholesky_factorization.html#a7b57d2c2ed95f5b959f96748c02c8c15">CholeskyFactorization</a>(A);</div>
<div class="line">cholesky-&gt;<a class="code" href="class_factored_solver.html#a0f59532de07e4563af5e65c698f9828e">factorize</a>();</div>
<div class="line"> </div>
<div class="line"><a class="code" href="class_matrix.html">Matrix</a> b = <a class="code" href="class_matrix_factory.html#a428c5bf7e3aadbbfebac2f6b699a3649">MatrixFactory::MakeRandomMatrix</a>(n, 1, 0.0, 5.0);</div>
<div class="line"><a class="code" href="class_matrix.html">Matrix</a> sol(n,1);</div>
<div class="line"><span class="keywordtype">int</span> status = cholesky-&gt;<a class="code" href="class_factored_solver.html#a1aad3c1b01664ea7a29150fc881793e6">solve</a>(b, sol);</div>
<div class="line"> </div>
<div class="line">std::cout &lt;&lt; status &lt;&lt; std::endl;    </div>
<div class="line"><span class="keywordtype">double</span> error = (A*sol-b).norm_fro_sq();</div>
<div class="line">std::cout &lt;&lt; error;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">delete</span> cholesky;</div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7b57d2c2ed95f5b959f96748c02c8c15"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CholeskyFactorization::CholeskyFactorization </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>m_matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a new instance of <a class="el" href="class_cholesky_factorization.html" title="Cholesky factorization and solver. ">CholeskyFactorization</a> given a Matrix object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_matrix</td><td>matrix to factorize </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4e34c50b16d9f5040997a8ec6e00b0e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int CholeskyFactorization::factorize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Computes the Cholesky factorization of this matrix.</p>
<p>If applied on a <code>MATRIX_DENSE</code> matrix, then it is assumed it is symmetric (but there is no verification) and only its lower triangular part is considered. Notice that the Cholesky factorization can only be applied to symmetric and positive definite matrices.</p>
<dl class="section return"><dt>Returns</dt><dd>status code. Returns <code>0</code> if the factorization succeeded. </dd></dl>

<p>Implements <a class="el" href="class_factored_solver.html#a0f59532de07e4563af5e65c698f9828e">FactoredSolver</a>.</p>

</div>
</div>
<a class="anchor" id="a7e46b9cc9fd6390847563468edc06350"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int CholeskyFactorization::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>solution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Solves the linear system \(LL^{\top}x = b\), where \(L\) is the current factorization (implicitly), \(b\) is a given right-hand side vector or matrix (given as an instance of <code>Martrix</code>) and \(x\) is the solution which is returned by this method.</p>
<p>Note that if this is a <code>MATRIX_DENSE</code> matrix, then it is assumed it is lower triangular (but there is no verification) and only its lower triangular part is considered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">solution</td><td>the solution of the linear system as an instance of <code><a class="el" href="class_matrix.html" title="A generic matrix API. ">Matrix</a></code> </td></tr>
    <tr><td class="paramname">rhs</td><td>The right-hand side vector or matrix</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns <code>0</code> if the solution of the system has succeeded.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Method <a class="el" href="class_cholesky_factorization.html#a7e46b9cc9fd6390847563468edc06350">solve</a> does not make use of the reference to the original matrix, so it is not a problem if that matrix goes out of scope, is altered or deleted.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Test <a class="el" href="class_cholesky_factorization.html#a7e46b9cc9fd6390847563468edc06350">solve()</a> when rhs is sparse </dd></dl>

<p>Implements <a class="el" href="class_factored_solver.html#a1aad3c1b01664ea7a29150fc881793e6">FactoredSolver</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>source/<a class="el" href="_cholesky_factorization_8h_source.html">CholeskyFactorization.h</a></li>
<li>source/CholeskyFactorization.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 7 2016 19:43:34 for LibForBES by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
